package com.johnpolacek.application{		import com.asual.SWFAddress;	import com.asual.SWFAddressEvent;	import com.greensock.TweenLite;	import com.greensock.easing.Expo;	import com.johnpolacek.components.ContentPanel;	import com.johnpolacek.components.LightboxContentInfo;	import com.johnpolacek.shapes.RectangleShape;	import com.johnpolacek.ui.BasicButtonMenu;		import flash.display.DisplayObject;	import flash.display.Sprite;	import flash.display.StageDisplayState;	import flash.events.Event;	import flash.events.IOErrorEvent;	import flash.events.TextEvent;	import flash.net.URLLoader;	import flash.net.URLRequest;	 /** * An xml-based site template designed for displaying case studies. *  * @version  * <b>02 Jun 2010</b>  <br>  * * @author John Polacek, john@johnpolacek.com */	 		public class CaseStudy extends FullScreenSite	{				public var quoteContainer:Sprite = new Sprite();				public function CaseStudy()		{			super();		}				/** Load complete handler for runtime.swf **/		override public function onRuntimeAssetsLoadComplete(event:Event = null):void		{			trace("CaseStudy.onRuntimeAssetsLoadComplete");			addSectionContainer();			centerContainer();		}				/** Actions initiated after sidebar load is complete **/		override public function onSidebarLoadComplete(event:Event = null):void		{			trace("CaseStudy.onSidebarLoadComplete");			if (event)			{				transitionSidebarIn();			}			onSiteLoadComplete();		}				/** Sets container position and size **/		override public function configureContainer():void		{			trace("CaseStudy.configureContainer");			containerWidth = format.sectionFormat.width + format.sidebarFormat.width + format.margin * 2;			container.y = format.margin;		}				/** Actions initiated after footer load is complete **/		override public function onFooterLoadComplete(event:Event = null):void		{			trace("FullScreenSite.onFooterLoadComplete");			if (event)				transitionFooterIn();		}				/** Adds content container **/		override public function addSectionContainer():void		{			trace("CaseStudy.addSectionContainer");			container.addChild(sectionContainer);			if (useSWFAddress)				SWFAddress.addEventListener(SWFAddressEvent.CHANGE, onSWFAddressChange);			else				changeSection(0);		}		/** Loads section 		 *	@param sectionIndex Section index to load		 **/		override public function loadSection(sectionIndex:int = 0):void		{			track("Section Load", siteXML.sections.section[sectionIndex].@title);						var section:ContentPanel = new ContentPanel();			section.styleSheet = format.textStyleSheet;			section.contentPath = format.contentPath;			section.setFormat(format.sectionFormat);			section.loadElementFromXML("xml/"+siteXML.sections.section[sectionIndex]);			section.addEventListener(Event.COMPLETE, onSectionLoadComplete);			section.visible = false;						// clear quote container			while (quoteContainer.numChildren > 0)				quoteContainer.removeChildAt(0);						// load and add quote to container			if (String(siteXML.sections.section[sectionIndex].@quote) != "")			{				var quote:ContentPanel = new ContentPanel();				quote.styleSheet = format.textStyleSheet;				quote.contentPath = format.contentPath;				quote.format.width = int(siteXML.quote.width);				quote.loadElementFromXML("xml/"+siteXML.sections.section[sectionIndex].@quote);				quoteContainer.addChild(quote);			}		}				/** Transition in animation for content sections **/		override public function transitionSectionInComplete(section:DisplayObject):void		{			trace("CaseStudy.transitionSectionInComplete");			if (!scrollbar)				TweenLite.delayedCall(.5, initScrollbar);						TweenLite.delayedCall(.51, onStageResize);						if (!siteLoadCompleted)				onSiteLoadComplete();		}				/** Actions initiated after site load is complete **/		override public function onSiteLoadComplete():void		{			trace("CaseStudy.onSiteLoadComplete");			createNav();			initLightbox();			// onStageResize();			if (siteXML.hasOwnProperty("fullscreen"))				addFullScreenButton();			track("Site Load Complete");			siteLoadCompleted = true;						var hasQuotes:Boolean = String(siteXML.quote.x)!="" && String(siteXML.quote.y)!="";			trace("CaseStudy hasQuotes = "+hasQuotes);			if (hasQuotes)			{				quoteContainer.x = int(siteXML.quote.x);				quoteContainer.y = int(siteXML.quote.y);				container.addChild(quoteContainer);			}		}				/** Create navigation **/		override public function createNav():void		{			trace("CaseStudy.createNav");			// Set BasicButtonMenu properties			nav = new BasicButtonMenu();			nav.isVertical = true;			nav.spacing = format.nav.spacing;			nav.buttonAlpha = format.nav.alpha;			nav.rolloverColor = format.nav.rolloverColor;			nav.selectColor = format.nav.selectColor;						// Set section titles			var sectionTitles = [];			for each (var sectionXML:XML in siteXML.sections.section) 			{				sectionTitles.push(sectionXML.@title);			}						// Create nav buttons			for each (var sectionTitle:String in sectionTitles) 			{				var navButton:Sprite = createNavButton(sectionTitle);				nav.addButton(navButton);			}			nav.x = siteXML.nav.x;			nav.y = siteXML.nav.y;									container.addChild(nav);				}	}}